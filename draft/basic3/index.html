<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="/umi.css" />
    <script>
      window.routerBase = "/";
    </script>
    <script>
      //! umi version: 3.2.22
    </script>
    <title>MySQL基础3</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" href="/">MySQL手册</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/basic">基础知识</a><a aria-current="page" class="active" href="/draft">草稿箱</a><a href="/wiki">Wiki</a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" href="/"></a><h1>MySQL手册</h1><p>MySQL手册</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/basic">基础知识</a></li><li><a aria-current="page" class="active" href="/draft">草稿箱</a></li><li><a href="/wiki">Wiki</a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/draft/basic1">MySQL基础1</a></li><li><a href="/draft/basic2">MySQL基础2</a></li><li><a aria-current="page" class="active" href="/draft/basic3">MySQL基础3</a></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="1. 为什么需要设计数据库" data-depth="2" class=""><a href="/draft/basic3#1-为什么需要设计数据库"><span>1. 为什么需要设计数据库</span></a></li><li title="1.1 良好的数据库设计" data-depth="3" class=""><a href="/draft/basic3#11-良好的数据库设计"><span>1.1 良好的数据库设计</span></a></li><li title="1.2 糟糕的数据库设计" data-depth="3" class=""><a href="/draft/basic3#12-糟糕的数据库设计"><span>1.2 糟糕的数据库设计</span></a></li><li title="2. 软件项目开发周期中的数据库设计" data-depth="2" class=""><a href="/draft/basic3#2-软件项目开发周期中的数据库设计"><span>2. 软件项目开发周期中的数据库设计</span></a></li><li title="3.设计数据库的步骤" data-depth="2" class=""><a href="/draft/basic3#3设计数据库的步骤"><span>3.设计数据库的步骤</span></a></li><li title="3.1 收集信息" data-depth="3" class=""><a href="/draft/basic3#31-收集信息"><span>3.1 收集信息</span></a></li><li title="3.2 标示实体(Entity)" data-depth="3" class=""><a href="/draft/basic3#32-标示实体entity"><span>3.2 标示实体(Entity)</span></a></li><li title="3.3 标示实体的属性(Attribute)" data-depth="3" class=""><a href="/draft/basic3#33-标示实体的属性attribute"><span>3.3 标示实体的属性(Attribute)</span></a></li><li title="3.4 标示实体之间的关系(RelationShip)" data-depth="3" class=""><a href="/draft/basic3#34-标示实体之间的关系relationship"><span>3.4 标示实体之间的关系(RelationShip)</span></a></li><li title="4. 数据库ER图" data-depth="2" class=""><a href="/draft/basic3#4-数据库er图"><span>4. 数据库ER图</span></a></li><li title="4.1 ER图的实体（entity）" data-depth="3" class=""><a href="/draft/basic3#41-er图的实体（entity）"><span>4.1 ER图的实体（entity）</span></a></li><li title="4.2 ER图的属性（attribute）" data-depth="3" class=""><a href="/draft/basic3#42-er图的属性（attribute）"><span>4.2 ER图的属性（attribute）</span></a></li><li title="4.3 ER图的关系（relationship）" data-depth="3" class=""><a href="/draft/basic3#43-er图的关系（relationship）"><span>4.3 ER图的关系（relationship）</span></a></li><li title="4.4 ER图中关联关系" data-depth="3" class=""><a href="/draft/basic3#44-er图中关联关系"><span>4.4 ER图中关联关系</span></a></li><li title="5. 数据库设计三大范式" data-depth="2" class=""><a href="/draft/basic3#5-数据库设计三大范式"><span>5. 数据库设计三大范式</span></a></li><li title="5.1 不合理的表设计" data-depth="3" class=""><a href="/draft/basic3#51-不合理的表设计"><span>5.1 不合理的表设计</span></a></li><li title="5.2 三大范式" data-depth="3" class=""><a href="/draft/basic3#52-三大范式"><span>5.2 三大范式</span></a></li><li title="5.RBAC" data-depth="2" class=""><a href="/draft/basic3#5rbac"><span>5.RBAC</span></a></li><li title="5.1 安全原则" data-depth="3" class=""><a href="/draft/basic3#51-安全原则"><span>5.1 安全原则</span></a></li><li title="5.2 ER图" data-depth="3" class=""><a href="/draft/basic3#52-er图"><span>5.2 ER图</span></a></li><li title="6.事务" data-depth="2" class=""><a href="/draft/basic3#6事务"><span>6.事务</span></a></li><li title="6.1 为什么需要事务" data-depth="3" class=""><a href="/draft/basic3#61-为什么需要事务"><span>6.1 为什么需要事务</span></a></li><li title="6.2 什么是事务" data-depth="3" class=""><a href="/draft/basic3#62-什么是事务"><span>6.2 什么是事务</span></a></li><li title="6.3 事务的特性" data-depth="3" class=""><a href="/draft/basic3#63-事务的特性"><span>6.3 事务的特性</span></a></li><li title="6.4 如何创建事务" data-depth="3" class=""><a href="/draft/basic3#64-如何创建事务"><span>6.4 如何创建事务</span></a></li><li title="7.在node中使用mysql" data-depth="2" class=""><a href="/draft/basic3#7在node中使用mysql"><span>7.在node中使用mysql</span></a></li><li title="7.1 使用mysql" data-depth="3" class=""><a href="/draft/basic3#71-使用mysql"><span>7.1 使用mysql</span></a></li><li title="7.2 使用mysql连接池" data-depth="3" class=""><a href="/draft/basic3#72-使用mysql连接池"><span>7.2 使用mysql连接池</span></a></li><li title="7.3 使用mysql事务" data-depth="3" class=""><a href="/draft/basic3#73-使用mysql事务"><span>7.3 使用mysql事务</span></a></li><li title="8.锁" data-depth="2" class=""><a href="/draft/basic3#8锁"><span>8.锁</span></a></li><li title="8.1 锁的分类" data-depth="3" class=""><a href="/draft/basic3#81-锁的分类"><span>8.1 锁的分类</span></a></li><li title="8.2 表锁" data-depth="3" class=""><a href="/draft/basic3#82-表锁"><span>8.2 表锁</span></a></li><li title="8.3 行锁" data-depth="3" class=""><a href="/draft/basic3#83-行锁"><span>8.3 行锁</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="mysql基础3"><a aria-hidden="true" href="#mysql基础3"><span class="icon icon-link"></span></a>MySQL基础3</h1><h2 id="1-为什么需要设计数据库"><a aria-hidden="true" href="#1-为什么需要设计数据库"><span class="icon icon-link"></span></a>1. 为什么需要设计数据库</h2><h3 id="11-良好的数据库设计"><a aria-hidden="true" href="#11-良好的数据库设计"><span class="icon icon-link"></span></a>1.1 良好的数据库设计</h3><ul><li>节省数据的存储空间</li><li>能够保证数据的完整性</li><li>方便进行数据库系统的开发</li></ul><h3 id="12-糟糕的数据库设计"><a aria-hidden="true" href="#12-糟糕的数据库设计"><span class="icon icon-link"></span></a>1.2 糟糕的数据库设计</h3><ul><li>数据冗余，存储空间浪费</li><li>内存空间浪费</li><li>数据和更新插入异常</li></ul><h2 id="2-软件项目开发周期中的数据库设计"><a aria-hidden="true" href="#2-软件项目开发周期中的数据库设计"><span class="icon icon-link"></span></a>2. 软件项目开发周期中的数据库设计</h2><ul><li>需求分析阶段: 分析客户的业务和数据处理需求</li><li>概要设计阶段： 设计数据库的E-R模型图，确认需求的正确和完整性</li><li>详细设计阶段： 应用三大范式审核数据库</li><li>代码编写阶段： 物理实现数据库，编码实现应用</li><li>软件测试阶段</li><li>安装部署</li></ul><blockquote><p>现实世界-&gt;信息世界-&gt;数据库模型图-&gt;数据库</p></blockquote><h2 id="3设计数据库的步骤"><a aria-hidden="true" href="#3设计数据库的步骤"><span class="icon icon-link"></span></a>3.设计数据库的步骤</h2><h3 id="31-收集信息"><a aria-hidden="true" href="#31-收集信息"><span class="icon icon-link"></span></a>3.1 收集信息</h3><p>与相关人员进行交流、访谈充分了解用户需求，理解数据库需要完成的任务</p><h3 id="32-标示实体entity"><a aria-hidden="true" href="#32-标示实体entity"><span class="icon icon-link"></span></a>3.2 标示实体(Entity)</h3><p>标识数据库要管理的关键对象或者实体，实体一般是名词</p><h3 id="33-标示实体的属性attribute"><a aria-hidden="true" href="#33-标示实体的属性attribute"><span class="icon icon-link"></span></a>3.3 标示实体的属性(Attribute)</h3><h3 id="34-标示实体之间的关系relationship"><a aria-hidden="true" href="#34-标示实体之间的关系relationship"><span class="icon icon-link"></span></a>3.4 标示实体之间的关系(RelationShip)</h3><h2 id="4-数据库er图"><a aria-hidden="true" href="#4-数据库er图"><span class="icon icon-link"></span></a>4. 数据库ER图</h2><p>ER图：实体关系图，简记E-R图，是指以实体、关系、属性三个基本概念概括数据的基本结构，从而描述静态数据结构的概念模式</p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040547.png" alt="er"/></p><h3 id="41-er图的实体（entity）"><a aria-hidden="true" href="#41-er图的实体（entity）"><span class="icon icon-link"></span></a>4.1 ER图的实体（entity）</h3><ul><li>ER图的实体（entity）即数据模型中的数据对象，例如人、学生、音乐都可以作为一个数据对象，用长方体来表示</li></ul><h3 id="42-er图的属性（attribute）"><a aria-hidden="true" href="#42-er图的属性（attribute）"><span class="icon icon-link"></span></a>4.2 ER图的属性（attribute）</h3><ul><li>ER图的属性（attribute）即数据对象所具有的属性，例如学生具有姓名、学号、年级等属性，用椭圆形表示</li><li>属性分为唯一属性（ unique attribute）和非唯一属性</li><li>唯一属性指的是唯一可用来标识该实体实例或者成员的属性，用下划线表示，一般来讲实体都至少有一个唯一属性。</li></ul><h3 id="43-er图的关系（relationship）"><a aria-hidden="true" href="#43-er图的关系（relationship）"><span class="icon icon-link"></span></a>4.3 ER图的关系（relationship）</h3><ul><li>ER图的关系（relationship）用来表现数据对象与数据对象之间的联系</li><li>例如学生的实体和成绩表的实体之间有一定的联系，每个学生都有自己的成绩表，这就是一种关系，关系用菱形来表示。</li></ul><h3 id="44-er图中关联关系"><a aria-hidden="true" href="#44-er图中关联关系"><span class="icon icon-link"></span></a>4.4 ER图中关联关系</h3><h4 id="441-1对1-11"><a aria-hidden="true" href="#441-1对1-11"><span class="icon icon-link"></span></a>4.4.1 1对1 (1:1)</h4><p>1对1关系是指对于实体集A与实体集B，A中的每一个实体至多与B中一个实体有关系；反之，在实体集B中的每个实体至多与实体集A中一个实体有关系。</p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040551.png" alt="er"/></p><h4 id="442-1对多（1n）"><a aria-hidden="true" href="#442-1对多（1n）"><span class="icon icon-link"></span></a>4.4.2 1对多（1:N）</h4><p>1对多关系是指实体集A与实体集B中至少有N(N&gt;0)个实体有关系；并且实体集B中每一个实体至多与实体集A中一个实体有关系。</p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040554.png" alt="er"/></p><h4 id="443-多对多（mn）"><a aria-hidden="true" href="#443-多对多（mn）"><span class="icon icon-link"></span></a>4.4.3 多对多（M:N）</h4><p>多对多关系是指实体集A中的每一个实体与实体集B中至少有M(M&gt;0)个实体有关系，并且实体集B中的每一个实体与实体集A中的至少N（N&gt;0）个实体有关系。</p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040557.png" alt="er"/></p><h2 id="5-数据库设计三大范式"><a aria-hidden="true" href="#5-数据库设计三大范式"><span class="icon icon-link"></span></a>5. 数据库设计三大范式</h2><h3 id="51-不合理的表设计"><a aria-hidden="true" href="#51-不合理的表设计"><span class="icon icon-link"></span></a>5.1 不合理的表设计</h3><ul><li>信息重复</li><li>更新异常</li><li>插入异常</li><li>删除异常</li></ul><h3 id="52-三大范式"><a aria-hidden="true" href="#52-三大范式"><span class="icon icon-link"></span></a>5.2 三大范式</h3><h4 id="521-第一范式（1nf）"><a aria-hidden="true" href="#521-第一范式（1nf）"><span class="icon icon-link"></span></a>5.2.1 第一范式（1NF）</h4><ul><li>数据表中的每一列（每个字段）必须是不可拆分的最小单元，也就是确保每一列的原子性；</li></ul><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040600.png" alt="firstpattern"/></p><h4 id="522-第二范式（2nf）"><a aria-hidden="true" href="#522-第二范式（2nf）"><span class="icon icon-link"></span></a>5.2.2 第二范式（2NF）</h4><ul><li>满足1NF后，要求表中的所有列，都必须依赖于主键，而不能有任何一列与主键没有关系，也就是说一个表只描述一件事情</li></ul><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040604.jpg" alt="2th1"/></p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040608.jpg" alt="2th2"/></p><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040612.jpg" alt="2th3"/></p><blockquote><p>一个人同时订几个房间，就会出来一个订单号多条数据，这样子联系人都是重复的，就会造成数据冗余</p></blockquote><h4 id="523-第三范式（3nf）"><a aria-hidden="true" href="#523-第三范式（3nf）"><span class="icon icon-link"></span></a>5.2.3 第三范式（3NF）</h4><ul><li>必须先满足第二范式（2NF），要求：表中的每一列只与主键直接相关而不是间接相关，(表中的每一列只能依赖于主键)</li><li>数据不能存在传递关系,即每个属性都跟主键有直接关系而不是间接关系</li></ul><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040615.png" alt="thirdpattern"/></p><h4 id="524-如何更好的区分三大范式"><a aria-hidden="true" href="#524-如何更好的区分三大范式"><span class="icon icon-link"></span></a>5.2.4 如何更好的区分三大范式</h4><ul><li>第一范式和第二范式的区别在于有没有分出两张表,第二范式是说一张表中包含了所种不同的实体属性，那么要必须分成多张表</li><li>第三范式是要求已经分成了多张表，那么一张表中只能有另一张表中的id（主键），而不能有其他的任何信息（其他的信息一律用外键在另一表的主键看查询）。</li></ul><h2 id="5rbac"><a aria-hidden="true" href="#5rbac"><span class="icon icon-link"></span></a>5.RBAC</h2><ul><li><p>基于角色的权限访问控制（Role-Based Access Control）</p></li><li><p>RBAC（Role-Based Access Control，基于角色的访问控制），就是用户通过角色与权限进行关联</p></li><li><p>简单地说，一个用户拥有若干角色，每一个角色拥有若干权限。这样，就构造成“用户-角色-权限-资源”的授权模型</p></li><li><p>在这种模型中，用户与角色之间，角色与权限之间，权限与资源之间一般是多对多的关系。</p></li><li><p>在RBAC中最重要的概念包括：用户(User)，角色(Role)，权限(Permission)，资源(Resource)</p></li></ul><h3 id="51-安全原则"><a aria-hidden="true" href="#51-安全原则"><span class="icon icon-link"></span></a>5.1 安全原则</h3><ul><li><p>最小权限原则之所以被RBAC所支持，是因为RBAC可以将其角色配置成其完成任务所需要的最小的权限集</p></li><li><p>责任分离原则可以通过调用相互独立互斥的角色来共同完成敏感的任务而体现，比如要求一个计帐员和财务管理员共参与同一过帐。</p></li><li><p>数据抽象可以通过权限的抽象来体现，如财务操作用借款、存款等抽象权限，而不用操作系统提供的典型的读、写、执行权限</p></li></ul><h3 id="52-er图"><a aria-hidden="true" href="#52-er图"><span class="icon icon-link"></span></a>5.2 ER图</h3><p><img src="https://wsk-mweb.oss-cn-hangzhou.aliyuncs.com/ipic/2020-10-01-040620.png" alt="er"/></p><h4 id="521-用户表"><a aria-hidden="true" href="#521-用户表"><span class="icon icon-link"></span></a>5.2.1 用户表</h4><table><thead><tr><th align="left">字段</th><th align="left">字段名</th><th align="left">类型</th><th align="left">默认</th></tr></thead><tbody><tr><td align="left">id</td><td align="left">ID</td><td align="left">int(11)</td><td align="left"></td></tr><tr><td align="left">username</td><td align="left">用户名</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">password</td><td align="left">密码</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">email</td><td align="left">邮箱</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">phone</td><td align="left">手机号</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">gender</td><td align="left">性别</td><td align="left">tinyint</td><td align="left"></td></tr><tr><td align="left">birthday</td><td align="left">生日</td><td align="left">datetime</td><td align="left"></td></tr><tr><td align="left">addresss</td><td align="left">地址</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">create_time</td><td align="left">创建时间</td><td align="left">datetime</td><td align="left">CURRENT_TIMESTAMP</td></tr><tr><td align="left">last_login</td><td align="left">上次登录时间</td><td align="left">datetime</td><td align="left"></td></tr><tr><td align="left">status</td><td align="left">状态</td><td align="left">tinyint</td><td align="left">1</td></tr></tbody></table><h4 id="522-角色表"><a aria-hidden="true" href="#522-角色表"><span class="icon icon-link"></span></a>5.2.2 角色表</h4><table><thead><tr><th align="left">字段</th><th align="left">字段名</th><th align="left">类型</th><th align="left">默认</th></tr></thead><tbody><tr><td align="left">id</td><td align="left">ID</td><td align="left">int(11)</td><td align="left"></td></tr><tr><td align="left">name</td><td align="left">名称</td><td align="left">varchar(255)</td><td align="left"></td></tr><tr><td align="left">create_time</td><td align="left">创建时间</td><td align="left">datetime</td><td align="left">CURRENT_TIMESTAMP</td></tr><tr><td align="left">status</td><td align="left">状态</td><td align="left">tinyint</td><td align="left">1</td></tr></tbody></table><h4 id="523-资源表"><a aria-hidden="true" href="#523-资源表"><span class="icon icon-link"></span></a>5.2.3 资源表</h4><table><thead><tr><th align="left">字段</th><th align="left">字段名</th><th align="left">类型</th><th align="left">默认</th><th></th></tr></thead><tbody><tr><td align="left">id</td><td align="left">ID</td><td align="left">int(11)</td><td align="left"></td><td></td></tr><tr><td align="left">name</td><td align="left">名称</td><td align="left">varchar(255)</td><td align="left"></td><td></td></tr><tr><td align="left">key</td><td align="left">路径</td><td align="left">varchar(255)</td><td align="left"></td><td></td></tr><tr><td align="left">create_time</td><td align="left">创建时间</td><td align="left">datetime</td><td align="left">CURRENT_TIMESTAMP</td><td></td></tr><tr><td align="left">status</td><td align="left">状态</td><td align="left">tinyint</td><td align="left">1</td><td></td></tr></tbody></table><h4 id="524-用户角色表"><a aria-hidden="true" href="#524-用户角色表"><span class="icon icon-link"></span></a>5.2.4 用户角色表</h4><table><thead><tr><th align="left">字段</th><th align="left">字段名</th><th align="left">类型</th></tr></thead><tbody><tr><td align="left">user_id</td><td align="left">用户ID</td><td align="left">int(11)</td></tr><tr><td align="left">role_id</td><td align="left">角色ID</td><td align="left">int(11)</td></tr></tbody></table><h4 id="525-角色资源"><a aria-hidden="true" href="#525-角色资源"><span class="icon icon-link"></span></a>5.2.5 角色资源</h4><table><thead><tr><th align="left">字段</th><th align="left">字段名</th><th align="left">类型</th></tr></thead><tbody><tr><td align="left">role_id</td><td align="left">角色ID</td><td align="left">int(11)</td></tr><tr><td align="left">resource_id</td><td align="left">资源ID</td><td align="left">int(11)</td></tr></tbody></table><h4 id="53-数据库脚本"><a aria-hidden="true" href="#53-数据库脚本"><span class="icon icon-link"></span></a>5.3 数据库脚本</h4><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="ALTER TABLE `categories` DROP FOREIGN KEY `fk_category_parent_id`;
ALTER TABLE `articles` DROP FOREIGN KEY `fk_article_category_id`;
ALTER TABLE `user_role` DROP FOREIGN KEY `fk_user_role_user_id`;
ALTER TABLE `user_role` DROP FOREIGN KEY `fk_user_role_role_id`;
ALTER TABLE `role_resource` DROP FOREIGN KEY `fk_role_resource_role_id`;
ALTER TABLE `role_resource` DROP FOREIGN KEY `fk_role_resource_resource_id`;

DROP TABLE `users`;
DROP TABLE `carousels`;
DROP TABLE `categories`;
DROP TABLE `articles`;
DROP TABLE `navigations`;
DROP TABLE `links`;
DROP TABLE `config`;
DROP TABLE `roles`;
DROP TABLE `user_role`;
DROP TABLE `resources`;
DROP TABLE `role_resource`;

CREATE TABLE `users` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`username` varchar(255) NULL,
`password` varchar(255) NULL,
`last_login` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
`email` varchar(255) NULL,
`phone` varchar(255) NULL,
`gender` tinyint(255) NULL,
`birthday` datetime NULL,
`address` varchar(255) NULL,
PRIMARY KEY (`id`) 
);
CREATE TABLE `carousels` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`title` varchar(255) NULL,
`url` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
PRIMARY KEY (`id`) 
);
CREATE TABLE `categories` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`title` varchar(255) NULL,
`description` varchar(255) NULL,
`keywords` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
`parent_id` int(11) NULL,
PRIMARY KEY (`id`) 
);
CREATE TABLE `articles` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`category_id` int(11) NULL,
`title` varchar(255) NULL,
`content` text NULL,
`user_id` int(255) NULL,
`keywords` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
`pv` int(255) NULL,
PRIMARY KEY (`id`) 
);
CREATE TABLE `navigations` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`title` varchar(255) NULL,
`url` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
PRIMARY KEY (`id`) 
);
CREATE TABLE `links` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`title` varchar(255) NULL,
`logo` varchar(255) NULL,
`url` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
PRIMARY KEY (`id`) 
);
CREATE TABLE `config` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`name` varchar(255) NULL,
`logo` varchar(255) NULL,
`url` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
`keywords` varchar(255) NULL,
`description` varchar(255) NULL,
`icp` varchar(255) NULL,
`about` varchar(255) NULL,
PRIMARY KEY (`id`) 
);
CREATE TABLE `roles` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`name` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
PRIMARY KEY (`id`) 
);
CREATE TABLE `user_role` (
`user_id` int(11) NOT NULL AUTO_INCREMENT,
`role_id` int(255) NOT NULL,
PRIMARY KEY (`user_id`, `role_id`) 
);
CREATE TABLE `resources` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`name` varchar(255) NOT NULL,
`key` varchar(255) NULL,
`create_time` datetime NULL DEFAULT CURRENT_TIMESTAMP,
`status` tinyint(255) NULL DEFAULT 1,
PRIMARY KEY (`id`) 
);
CREATE TABLE `role_resource` (
`role_id` int(11) NOT NULL AUTO_INCREMENT,
`resource_id` int(255) NOT NULL,
PRIMARY KEY (`role_id`, `resource_id`) 
);

ALTER TABLE `categories` ADD CONSTRAINT `fk_category_parent_id` FOREIGN KEY (`parent_id`) REFERENCES `categories` (`id`);
ALTER TABLE `articles` ADD CONSTRAINT `fk_article_category_id` FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`);
ALTER TABLE `user_role` ADD CONSTRAINT `fk_user_role_user_id` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`);
ALTER TABLE `user_role` ADD CONSTRAINT `fk_user_role_role_id` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`);
ALTER TABLE `role_resource` ADD CONSTRAINT `fk_role_resource_role_id` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`);
ALTER TABLE `role_resource` ADD CONSTRAINT `fk_role_resource_resource_id` FOREIGN KEY (`resource_id`) REFERENCES `resources` (`id`);
" data-status="copy"></button><div class="token-line"><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_category_parent_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">articles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_article_category_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_user_role_user_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_user_role_role_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_role_resource_role_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_role_resource_resource_id</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">users</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">carousels</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">articles</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">navigations</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">links</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">config</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">roles</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">resources</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">DROP</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">users</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">username</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">password</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">last_login</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">email</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">phone</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">gender</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">birthday</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">address</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">carousels</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">title</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">url</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">title</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">description</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">keywords</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">parent_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">articles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">category_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">title</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">content</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">text</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">user_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">keywords</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">pv</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">navigations</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">title</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">url</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">links</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">title</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">logo</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">url</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">config</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">name</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">logo</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">url</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">keywords</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">description</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">icp</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">about</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">roles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">name</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">user_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">user_id</span><span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">resources</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">name</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">key</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">create_time</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">datetime</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token keyword">status</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">`</span><span class="token plain">resource_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">resource_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_category_parent_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">parent_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">articles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_article_category_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">category_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">categories</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_user_role_user_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">user_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">users</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">user_role</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_user_role_role_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">roles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_role_resource_role_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">role_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">roles</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ALTER</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">role_resource</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">ADD</span><span class="token plain"> </span><span class="token keyword">CONSTRAINT</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">fk_role_resource_resource_id</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token keyword">FOREIGN</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">resource_id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">REFERENCES</span><span class="token plain"> </span><span class="token punctuation">`</span><span class="token plain">resources</span><span class="token punctuation">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token plain">id</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="6事务"><a aria-hidden="true" href="#6事务"><span class="icon icon-link"></span></a>6.事务</h2><h3 id="61-为什么需要事务"><a aria-hidden="true" href="#61-为什么需要事务"><span class="icon icon-link"></span></a>6.1 为什么需要事务</h3><ul><li>银行转账问题</li><li>A账户资金减少</li><li>B账户资金增加</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="create database bank;
use bank;
create table account
(
    name varchar(64),
    balance decimal(10,2)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
insert into account(name,balance) values(&#x27;张三&#x27;,100);
insert into account(name,balance) values(&#x27;李四&#x27;,100);

update account set balance = balance - 10 where name = &#x27;张三&#x27;;
update account set balance = balance + 10 where name = &#x27;李四&#x27;;
" data-status="copy"></button><div class="token-line"><span class="token keyword">create</span><span class="token plain"> </span><span class="token keyword">database</span><span class="token plain"> bank</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">use</span><span class="token plain"> bank</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">create</span><span class="token plain"> </span><span class="token keyword">table</span><span class="token plain"> account</span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    name </span><span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    balance </span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token plain"> </span><span class="token keyword">DEFAULT</span><span class="token plain"> </span><span class="token keyword">CHARSET</span><span class="token operator">=</span><span class="token plain">utf8</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">insert</span><span class="token plain"> </span><span class="token keyword">into</span><span class="token plain"> account</span><span class="token punctuation">(</span><span class="token plain">name</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#x27;张三&#x27;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">insert</span><span class="token plain"> </span><span class="token keyword">into</span><span class="token plain"> account</span><span class="token punctuation">(</span><span class="token plain">name</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">&#x27;李四&#x27;</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">update</span><span class="token plain"> account </span><span class="token keyword">set</span><span class="token plain"> balance </span><span class="token operator">=</span><span class="token plain"> balance </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token keyword">where</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;张三&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">update</span><span class="token plain"> account </span><span class="token keyword">set</span><span class="token plain"> balance </span><span class="token operator">=</span><span class="token plain"> balance </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token keyword">where</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;李四&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="62-什么是事务"><a aria-hidden="true" href="#62-什么是事务"><span class="icon icon-link"></span></a>6.2 什么是事务</h3><ul><li>事务是作为单个逻辑工作单元执行的一系列操作</li><li>多个操作作为一个整体向系统提交，要么都执行，要么都不执行</li><li>事务是一个不可分割的工作逻辑单元</li></ul><blockquote><p>转账过程就是一个整体，它需要两条UPDATE语句，如果任何一个出错，则整个转账业务取消，两个账户的余额都恢复到原来的数据，确保总余额不变</p></blockquote><h3 id="63-事务的特性"><a aria-hidden="true" href="#63-事务的特性"><span class="icon icon-link"></span></a>6.3 事务的特性</h3><ul><li>原子性(Atomicity) 事务是一个完整的操作，事务各个部分是不可分的，要么都执行，要么都不执行</li><li>一致性(Consistency) 当事务完成后，数据必须处理完整的状态</li><li>隔离性(Isolation) 并发事务彼此隔离、独立，它不应该以任何方式依赖于其它事务</li><li>持久性(Durability) 事务完成后，它对数据库的修改被永久保持</li></ul><h3 id="64-如何创建事务"><a aria-hidden="true" href="#64-如何创建事务"><span class="icon icon-link"></span></a>6.4 如何创建事务</h3><ul><li>开始事务 <code>START TRANSACTION</code> 或者 <code>BEGIN</code></li><li>提交事务 <code>COMMIT</code></li><li>回滚或者说撤销事务 <code>ROLLBACK</code></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="BEGIN;
update account set balance = balance - 10 where name = &#x27;张三&#x27;;
ROLLBACK;
" data-status="copy"></button><div class="token-line"><span class="token keyword">BEGIN</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">update</span><span class="token plain"> account </span><span class="token keyword">set</span><span class="token plain"> balance </span><span class="token operator">=</span><span class="token plain"> balance </span><span class="token operator">-</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token keyword">where</span><span class="token plain"> name </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;张三&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li>默认情况下，每条单独的SQL语句视为一个事务</li><li>关闭默认提交状态后，可手动开启、关闭事务</li><li>关闭/开启自动提交状态 <code>SET autocommit=0|1</code> 0关闭 1开启</li></ul><blockquote><p>关闭自动提交后，从下一条SQL语句开始开启新的事务，需要使用COMMIT或ROLLBACK结束该事务</p></blockquote><h2 id="7在node中使用mysql"><a aria-hidden="true" href="#7在node中使用mysql"><span class="icon icon-link"></span></a>7.在node中使用mysql</h2><ul><li><a href="https://www.npmjs.com/package/mysql" target="_blank" rel="noopener noreferrer">mysql<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="npm install mysql
" data-status="copy"></button><div class="token-line"><span class="token plain">npm install mysql</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="71-使用mysql"><a aria-hidden="true" href="#71-使用mysql"><span class="icon icon-link"></span></a>7.1 使用mysql</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="var mysql      = require(&#x27;mysql&#x27;);
var connection = mysql.createConnection({
  host     : &#x27;localhost&#x27;,
  user     : &#x27;me&#x27;,
  password : &#x27;secret&#x27;,
  database : &#x27;my_db&#x27;
});

connection.connect();

connection.query(&#x27;SELECT 1 + 1 AS solution&#x27;, function (error, results, fields) {
  if (error) throw error;
  console.log(&#x27;The solution is: &#x27;, results[0].solution);
});

connection.end();
" data-status="copy"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> mysql      </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;mysql&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> connection </span><span class="token operator">=</span><span class="token plain"> mysql</span><span class="token punctuation">.</span><span class="token method function property-access">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  host     </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;localhost&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  user     </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;me&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  password </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;secret&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  database </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;my_db&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">connection</span><span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">connection</span><span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span><span class="token string">&#x27;SELECT 1 + 1 AS solution&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token parameter punctuation">,</span><span class="token parameter"> results</span><span class="token parameter punctuation">,</span><span class="token parameter"> fields</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">throw</span><span class="token plain"> error</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;The solution is: &#x27;</span><span class="token punctuation">,</span><span class="token plain"> results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">solution</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">connection</span><span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="72-使用mysql连接池"><a aria-hidden="true" href="#72-使用mysql连接池"><span class="icon icon-link"></span></a>7.2 使用mysql连接池</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="var mysql = require(&#x27;mysql&#x27;);
var pool  = mysql.createPool({
  connectionLimit : 10,
  host            : &#x27;example.org&#x27;,
  user            : &#x27;bob&#x27;,
  password        : &#x27;secret&#x27;,
  database        : &#x27;my_db&#x27;
});

pool.query(&#x27;SELECT 1 + 1 AS solution&#x27;, function (error, results, fields) {
  if (error) throw error;
  console.log(&#x27;The solution is: &#x27;, results[0].solution);
});
" data-status="copy"></button><div class="token-line"><span class="token keyword">var</span><span class="token plain"> mysql </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;mysql&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> pool  </span><span class="token operator">=</span><span class="token plain"> mysql</span><span class="token punctuation">.</span><span class="token method function property-access">createPool</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  connectionLimit </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  host            </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;example.org&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  user            </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;bob&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  password        </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;secret&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  database        </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;my_db&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">pool</span><span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span><span class="token string">&#x27;SELECT 1 + 1 AS solution&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token parameter punctuation">,</span><span class="token parameter"> results</span><span class="token parameter punctuation">,</span><span class="token parameter"> fields</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">throw</span><span class="token plain"> error</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;The solution is: &#x27;</span><span class="token punctuation">,</span><span class="token plain"> results</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">solution</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="73-使用mysql事务"><a aria-hidden="true" href="#73-使用mysql事务"><span class="icon icon-link"></span></a>7.3 使用mysql事务</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="connection.beginTransaction(function(err) {
  if (err) { throw err; }
  connection.query(&#x27;INSERT INTO posts SET title=?&#x27;, title, function (error, results, fields) {
    if (error) {
      return connection.rollback(function() {
        throw error;
      });
    }

    var log = &#x27;Post &#x27; + results.insertId + &#x27; added&#x27;;

    connection.query(&#x27;INSERT INTO log SET data=?&#x27;, log, function (error, results, fields) {
      if (error) {
        return connection.rollback(function() {
          throw error;
        });
      }
      connection.commit(function(err) {
        if (err) {
          return connection.rollback(function() {
            throw err;
          });
        }
        console.log(&#x27;success!&#x27;);
      });
    });
  });
});
" data-status="copy"></button><div class="token-line"><span class="token plain">connection</span><span class="token punctuation">.</span><span class="token method function property-access">beginTransaction</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">err</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token keyword">throw</span><span class="token plain"> err</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  connection</span><span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span><span class="token string">&#x27;INSERT INTO posts SET title=?&#x27;</span><span class="token punctuation">,</span><span class="token plain"> title</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token parameter punctuation">,</span><span class="token parameter"> results</span><span class="token parameter punctuation">,</span><span class="token parameter"> fields</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> connection</span><span class="token punctuation">.</span><span class="token method function property-access">rollback</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">throw</span><span class="token plain"> error</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">var</span><span class="token plain"> log </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;Post &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> results</span><span class="token punctuation">.</span><span class="token property-access">insertId</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27; added&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    connection</span><span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span><span class="token string">&#x27;INSERT INTO log SET data=?&#x27;</span><span class="token punctuation">,</span><span class="token plain"> log</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token parameter punctuation">,</span><span class="token parameter"> results</span><span class="token parameter punctuation">,</span><span class="token parameter"> fields</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">error</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">return</span><span class="token plain"> connection</span><span class="token punctuation">.</span><span class="token method function property-access">rollback</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token keyword">throw</span><span class="token plain"> error</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      connection</span><span class="token punctuation">.</span><span class="token method function property-access">commit</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">err</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token keyword">return</span><span class="token plain"> connection</span><span class="token punctuation">.</span><span class="token method function property-access">rollback</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">throw</span><span class="token plain"> err</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;success!&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="8锁"><a aria-hidden="true" href="#8锁"><span class="icon icon-link"></span></a>8.锁</h2><ul><li>锁时计算机协调多个进程或线程并发访问某一资源的机制</li></ul><h3 id="81-锁的分类"><a aria-hidden="true" href="#81-锁的分类"><span class="icon icon-link"></span></a>8.1 锁的分类</h3><ul><li>从对数据库操作的类型分，分为读锁和写锁<ul><li>读锁（共享锁）：针对同一份数据，多个读操作可以同时进行而不会互相影响</li><li>写锁（排它锁）：当前写操作没有完成前，它会阻断其他写锁和读锁</li></ul></li><li>从对数据操作的粒度分，分为<ul><li>表锁</li><li>行锁</li></ul></li></ul><h3 id="82-表锁"><a aria-hidden="true" href="#82-表锁"><span class="icon icon-link"></span></a>8.2 表锁</h3><ul><li>表锁偏向<code>MyISAM</code>存储引擎，开销小，加锁快，锁定粒度大，发生锁冲突的概率最高，并发度最低</li></ul><h4 id="821-准备数据"><a aria-hidden="true" href="#821-准备数据"><span class="icon icon-link"></span></a>8.2.1 准备数据</h4><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="CREATE TABLE `users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `NAME` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

INSERT INTO `users` (`id`, `NAME`) VALUES (&#x27;1&#x27;, &#x27;a&#x27;);
INSERT INTO `users` (`id`, `NAME`) VALUES (&#x27;2&#x27;, &#x27;b&#x27;);
INSERT INTO `users` (`id`, `NAME`) VALUES (&#x27;3&#x27;, &#x27;c&#x27;);
INSERT INTO `users` (`id`, `NAME`) VALUES (&#x27;4&#x27;, &#x27;d&#x27;);


lock table 表名称 read(write),表名称2 read(write);
unlock tables;
" data-status="copy"></button><div class="token-line"><span class="token constant">CREATE</span><span class="token plain"> </span><span class="token constant">TABLE</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">users</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token function">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">NOT</span><span class="token plain"> </span><span class="token constant">NULL</span><span class="token plain"> </span><span class="token constant">AUTO_INCREMENT</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">NAME</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">DEFAULT</span><span class="token plain"> </span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">PRIMARY</span><span class="token plain"> </span><span class="token constant">KEY</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">ENGINE</span><span class="token operator">=</span><span class="token maybe-class-name">MyISAM</span><span class="token plain"> </span><span class="token constant">DEFAULT</span><span class="token plain"> </span><span class="token constant">CHARSET</span><span class="token operator">=</span><span class="token plain">utf8</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">INSERT</span><span class="token plain"> </span><span class="token constant">INTO</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">users</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">NAME</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">VALUES</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;a&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">INSERT</span><span class="token plain"> </span><span class="token constant">INTO</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">users</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">NAME</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">VALUES</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;b&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">INSERT</span><span class="token plain"> </span><span class="token constant">INTO</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">users</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">NAME</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">VALUES</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;3&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;c&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token constant">INSERT</span><span class="token plain"> </span><span class="token constant">INTO</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">users</span><span class="token template-string template-punctuation string">`</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">id</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token template-string template-punctuation string">`</span><span class="token template-string string">NAME</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">VALUES</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token string">&#x27;4&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;d&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">lock table 表名称 </span><span class="token function">read</span><span class="token punctuation">(</span><span class="token plain">write</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain">表名称</span><span class="token number">2</span><span class="token plain"> </span><span class="token function">read</span><span class="token punctuation">(</span><span class="token plain">write</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">unlock tables</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h4 id="822-加读锁"><a aria-hidden="true" href="#822-加读锁"><span class="icon icon-link"></span></a>8.2.2 加读锁</h4><table><thead><tr><th align="left">会话1</th><th align="left">会话2</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">lock table users read;</td><td align="left">连接数据库</td><td align="left"></td></tr><tr><td align="left">select * from users;</td><td align="left">select * from users;</td><td align="left">都可以查询</td></tr><tr><td align="left">select * from role;</td><td align="left">select * from role;</td><td align="left">会话1不能查询没有锁定的表，会话2可以查询没有锁定的表或更新未锁定的表</td></tr><tr><td align="left">INSERT INTO <code>users</code> (<code>id</code>, <code>NAME</code>) VALUES (&#x27;5&#x27;, &#x27;e&#x27;);</td><td align="left">INSERT INTO <code>users</code> (<code>id</code>, <code>NAME</code>) VALUES (&#x27;5&#x27;, &#x27;e&#x27;);</td><td align="left">会话1插入或更新会提示错误，会话2插入或更新会提示等待</td></tr><tr><td align="left">unlock tables;</td><td align="left">INSERT INTO <code>users</code> (<code>id</code>, <code>NAME</code>) VALUES (&#x27;5&#x27;, &#x27;e&#x27;);</td><td align="left">会话1释放锁后，会话2完成插入操作</td></tr></tbody></table><h4 id="823-加写锁"><a aria-hidden="true" href="#823-加写锁"><span class="icon icon-link"></span></a>8.2.3 加写锁</h4><table><thead><tr><th align="left">会话1</th><th align="left">会话2</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">lock table users write;</td><td align="left">连接数据库</td><td align="left"></td></tr><tr><td align="left">select * from users;</td><td align="left">select * from users;</td><td align="left">会话1可以对锁定表进行插入更新和删除操作,会话2的查询操作也会被阻塞</td></tr><tr><td align="left">unlock tables;</td><td align="left"></td><td align="left">会话1释放锁，会话2返回结果</td></tr></tbody></table><blockquote><p>读锁会阻塞写，但是不会阻塞读。而写锁则会把读和写都阻塞</p></blockquote><h3 id="83-行锁"><a aria-hidden="true" href="#83-行锁"><span class="icon icon-link"></span></a>8.3 行锁</h3><ul><li>行锁偏向InnoDB存储引擎，开销大，加锁慢，会出现死锁，锁定粒度最小，发生锁冲突的概率最低，并发度也最高</li><li>InnoDB与MYISAM的最大不同有两点：一是支持事务（TRANSACTION）；二是采用了行级锁</li></ul><h4 id="831-行锁支持事务"><a aria-hidden="true" href="#831-行锁支持事务"><span class="icon icon-link"></span></a>8.3.1 行锁支持事务</h4><h5 id="8311-并发事务处理带来的问题"><a aria-hidden="true" href="#8311-并发事务处理带来的问题"><span class="icon icon-link"></span></a>8.3.1.1 并发事务处理带来的问题</h5><h6 id="83111-更新丢失（lost-update）"><a aria-hidden="true" href="#83111-更新丢失（lost-update）"><span class="icon icon-link"></span></a>8.3.1.1.1 更新丢失（Lost Update）</h6><ul><li>当两个或多个事务选择同一行，然后基于最初选定的值更新该行时，由于每个事务都不知道其他事务的存在，就会发生丢失更新问题–最后的更新覆盖了由其他事务所做的更新。</li><li>后面的事务覆盖了前面的值,这是正常现象</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="create table account3 (id int,balance int) ENGINE=InnoDB;
insert into account3(id,balance) values(1,100);
insert into account3(id,balance) values(2,100);
set autocommit=0;
begin;
update account3 set balance=90 where id=1;
commit;
set autocommit=0;
begin;
update account3 set balance=80 where id=1;
commit;
" data-status="copy"></button><div class="token-line"><span class="token plain">create table </span><span class="token function">account3</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">id int</span><span class="token punctuation">,</span><span class="token plain">balance int</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token constant">ENGINE</span><span class="token operator">=</span><span class="token maybe-class-name">InnoDB</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">insert into </span><span class="token function">account3</span><span class="token punctuation">(</span><span class="token plain">id</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token function">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">insert into </span><span class="token function">account3</span><span class="token punctuation">(</span><span class="token plain">id</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token function">values</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">set</span><span class="token plain"> autocommit</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">begin</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">update account3 </span><span class="token keyword">set</span><span class="token plain"> balance</span><span class="token operator">=</span><span class="token number">90</span><span class="token plain"> where id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">commit</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">set</span><span class="token plain"> autocommit</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">begin</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">update account3 </span><span class="token keyword">set</span><span class="token plain"> balance</span><span class="token operator">=</span><span class="token number">80</span><span class="token plain"> where id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">commit</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h6 id="83112-脏读（dirty-reads）"><a aria-hidden="true" href="#83112-脏读（dirty-reads）"><span class="icon icon-link"></span></a>8.3.1.1.2 脏读（Dirty Reads）</h6><ul><li>一个事务正在对一条记录做修改，在这个事务完成并提交前，这条记录的数据就处于不一致的状态；这时，另一个事务也来读取同一条记录，如果不加控制，第二个事务读取了这些<code>脏</code>数据，并据此作进一步的处理，就会产生未提交的数据依赖关系。这种现象被形象的叫做<code>脏读</code>。</li><li>一句话：事务A读取到了事务B已经修改但尚未提交的数据，还在这个数据基础上做了操作。此时，如果B事务回滚，A读取的数据无效，不符合一致性要求。</li><li>脏读是事务B里面修改了数据 ,这是不正常的</li><li>解决办法：如果在第一个事务提交前，任何其他事务不可读取其修改过的值，则可 以避免该问题。</li></ul><p>修改日志的隔离级别</p><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="-- 支持的存储引擎
SHOW ENGINES;
-- 当前的数据库默认引擎
SHOW VARIABLES LIKE &#x27;storage_engine&#x27;;
SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
SET GLOBAL TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

SELECT @@global.tx_isolation;
SELECT @@session.tx_isolation;
SELECT @@tx_isolation;
start TRANSACTION;
insert into account3(id,balance) values(3,100);
start TRANSACTION;
select * from account3;
" data-status="copy"></button><div class="token-line"><span class="token comment">-- 支持的存储引擎</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SHOW</span><span class="token plain"> ENGINES</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">-- 当前的数据库默认引擎</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SHOW</span><span class="token plain"> VARIABLES </span><span class="token operator">LIKE</span><span class="token plain"> </span><span class="token string">&#x27;storage_engine&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">SESSION</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">READ</span><span class="token plain"> </span><span class="token keyword">UNCOMMITTED</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">GLOBAL</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">READ</span><span class="token plain"> </span><span class="token keyword">UNCOMMITTED</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@global.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@session.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">insert</span><span class="token plain"> </span><span class="token keyword">into</span><span class="token plain"> account3</span><span class="token punctuation">(</span><span class="token plain">id</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">select</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> account3</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h6 id="83113-不可重复读（non-repeatable-reads）"><a aria-hidden="true" href="#83113-不可重复读（non-repeatable-reads）"><span class="icon icon-link"></span></a>8.3.1.1.3 不可重复读（Non-Repeatable Reads）</h6><ul><li>一个事务在读取某些数据后的某个时间，再次读取以前读过的数据，却发现其读出的数据已经发生了改变、或某些记录已经被删除了！这种现象就叫做&quot;不可重复读&quot;。</li><li>一句话：事务A读取到了事务B已经提交的修改数据，不符合隔离性,这是不正常的</li><li>解决办法：如果只有在修改事务完全提交之后才可以读取数据，则可以避免该问题</li><li>针对的是update或delete</li></ul><p>修改日志级别</p><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="SET SESSION TRANSACTION ISOLATION LEVEL read committed;
SET GLOBAL TRANSACTION ISOLATION LEVEL read committed;
SELECT @@global.tx_isolation;
SELECT @@session.tx_isolation;
SELECT @@tx_isolation;
" data-status="copy"></button><div class="token-line"><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">SESSION</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">read</span><span class="token plain"> </span><span class="token keyword">committed</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">GLOBAL</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">read</span><span class="token plain"> </span><span class="token keyword">committed</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@global.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@session.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>会话2</p><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="start TRANSACTION;
select * from account3;
" data-status="copy"></button><div class="token-line"><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">select</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> account3</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>会话2</p><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="start TRANSACTION;
delete from account3 where id=1;
commit;
" data-status="copy"></button><div class="token-line"><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">delete</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> account3 </span><span class="token keyword">where</span><span class="token plain"> id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">commit</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h6 id="83114-幻读（phantom-reads）"><a aria-hidden="true" href="#83114-幻读（phantom-reads）"><span class="icon icon-link"></span></a>8.3.1.1.4 幻读（Phantom Reads）</h6><ul><li>一个事务按相同的查询条件重新读取以前检索过的数据，却发现其他事务插入了满足其查询条件的新数据，这种现象就称为&quot;幻读&quot;。</li><li>一句话：事务A读取到了事务B提交的新增数据，不符合隔离性</li><li>幻读是事务B里面新增了数据,这是不正常的</li><li>解决办法：如果在操作事务完成数据处理之前，任何其他事务都不可以添加新数据，则可避免该问题</li><li>针对的是 <code>insert</code></li><li>要更新隐藏的行之后才能看到幻读现象</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="SELECT @@tx_isolation;
SET SESSION TRANSACTION ISOLATION LEVEL repeatable read;
SET GLOBAL TRANSACTION ISOLATION LEVEL repeatable read;
SELECT @@global.tx_isolation;
SELECT @@session.tx_isolation;
SELECT @@tx_isolation;
start TRANSACTION;
insert into account3(id,balance) values(5,100);
commit;
start TRANSACTION;
select * from account3;
update account3 set balance =balance-10;
commit;
" data-status="copy"></button><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">SESSION</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">repeatable</span><span class="token plain"> </span><span class="token keyword">read</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SET</span><span class="token plain"> </span><span class="token keyword">GLOBAL</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token plain"> </span><span class="token keyword">ISOLATION</span><span class="token plain"> </span><span class="token keyword">LEVEL</span><span class="token plain"> </span><span class="token keyword">repeatable</span><span class="token plain"> </span><span class="token keyword">read</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@global.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@session.tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">insert</span><span class="token plain"> </span><span class="token keyword">into</span><span class="token plain"> account3</span><span class="token punctuation">(</span><span class="token plain">id</span><span class="token punctuation">,</span><span class="token plain">balance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">commit</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">start</span><span class="token plain"> </span><span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">select</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> account3</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">update</span><span class="token plain"> account3 </span><span class="token keyword">set</span><span class="token plain"> balance </span><span class="token operator">=</span><span class="token plain">balance</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">commit</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h5 id="8312-事务隔离五种级别"><a aria-hidden="true" href="#8312-事务隔离五种级别"><span class="icon icon-link"></span></a>8.3.1.2 事务隔离五种级别</h5><ul><li>read uncommitted : 读取尚未提交的数据 ：就是脏读</li><li>read committed：读取已经提交的数据 ：可以解决脏读</li><li>repeatable read：可重读读取：可以解决脏读和不可重复读 ---mysql默认的</li><li>serializable：串行化：可以解决 脏读、不可重复读和幻读---相当于锁表</li><li>Innodb的默认事务隔离级别是重复读 <code>repeatable read</code></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-sql"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="SELECT @@tx_isolation;
set session transaction isolation level
set session transaction isolation level read uncommitted;
" data-status="copy"></button><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> @</span><span class="token variable">@tx_isolation</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">set</span><span class="token plain"> </span><span class="token keyword">session</span><span class="token plain"> </span><span class="token keyword">transaction</span><span class="token plain"> </span><span class="token keyword">isolation</span><span class="token plain"> </span><span class="token keyword">level</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">set</span><span class="token plain"> </span><span class="token keyword">session</span><span class="token plain"> </span><span class="token keyword">transaction</span><span class="token plain"> </span><span class="token keyword">isolation</span><span class="token plain"> </span><span class="token keyword">level</span><span class="token plain"> </span><span class="token keyword">read</span><span class="token plain"> </span><span class="token keyword">uncommitted</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><table><thead><tr><th align="left">隔离级别</th><th align="left">脏读</th><th align="left">非重复读</th><th align="left">幻读</th></tr></thead><tbody><tr><td align="left">read uncommitted</td><td align="left">允许</td><td align="left">允许</td><td align="left">允许</td></tr><tr><td align="left">read committed</td><td align="left"></td><td align="left">允许</td><td align="left">允许</td></tr><tr><td align="left">repeatable read</td><td align="left"></td><td align="left"></td><td align="left">允许</td></tr><tr><td align="left">serializable</td><td align="left"></td><td align="left"></td><td align="left"></td></tr></tbody></table><h4 id="832-死锁"><a aria-hidden="true" href="#832-死锁"><span class="icon icon-link"></span></a>8.3.2 死锁</h4><ul><li>只有在INNODB引擎上的索引键上才会启用行级锁</li><li>Deadlock found when trying to get lock; try restarting transaction</li></ul><table><thead><tr><th align="left">会话1</th><th align="left">会话2</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">set autocommit=0</td><td align="left">set autocommit=0</td><td align="left">都关闭默认提交</td></tr><tr><td align="left">update account set balance = balance -10 where name = &#x27;张三&#x27;</td><td align="left">update account2 set balance = balance -10 where name = &#x27;李四&#x27;</td><td align="left"></td></tr><tr><td align="left">update account2 set balance = balance -10 where name = &#x27;李四&#x27;;</td><td align="left">update account2 set balance = balance -10 where name = &#x27;张三&#x27;;</td><td align="left"></td></tr></tbody></table><ul><li><a href="http://www.zsythink.net/archives/1233" target="_blank" rel="noopener noreferrer">日志级别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/weisuoke/mysql-guidebook/edit/master/docs/draft/basic3.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">2020-10-1 12:09:14</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/umi.js"></script>
    <script src="/docs__draft__basic3.md.js"></script>
  </body>
</html>
